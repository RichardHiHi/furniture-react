{"ast":null,"code":"import { ADD_TO_CART, CLEAR_CART, COUNT_CART_TOTALS, REMOVE_CART_ITEM, TOGGLE_CART_ITEM_AMOUNT } from '../actions';\n\nconst cart_reducer = (state, action) => {\n  if (action.type === COUNT_CART_TOTALS) {\n    const {\n      amount,\n      subtotal\n    } = state.cart.reduce((acc, item) => {\n      acc.amount += item.amount;\n      acc.subtotal += item.amount * item.price;\n      return acc;\n    }, {\n      amount: 0,\n      subtotal: 0\n    });\n    return { ...state,\n      amount: amount,\n      total: subtotal\n    };\n  }\n\n  if (action.type === ADD_TO_CART) {\n    const id = action.payload.product.id;\n    const color = action.payload.color;\n    let flag = false;\n    let newProduct = [];\n    const product = state.cart;\n\n    for (let i = 0; i < product.length; i++) {\n      if (product[i].id === id && product[i].mainColor === color) {\n        flag = true;\n        break;\n      }\n    }\n\n    if (flag) {\n      newProduct = state.cart.map(product => {\n        if (product.id === id && product.mainColor === color) {\n          let newAmount = product.amount + action.payload.product.amount;\n\n          if (newAmount > product.stock) {\n            newAmount = product.stock;\n          }\n\n          return { ...product,\n            amount: newAmount\n          };\n        }\n\n        return product;\n      });\n    } else {\n      newProduct = state.cart.concat(action.payload.product);\n    }\n\n    return { ...state,\n      cart: newProduct\n    };\n  }\n\n  if (action.type === CLEAR_CART) {\n    return { ...state,\n      cart: [],\n      total: 0,\n      amount: 0,\n      shipping: 345\n    };\n  }\n\n  if (action.type === REMOVE_CART_ITEM) {\n    const id = action.payload.id;\n    const color = action.payload.color;\n    const newCart = state.cart.filter(item => {\n      return item.id !== id && item.color !== color;\n    });\n    return { ...state,\n      cart: newCart\n    };\n  }\n\n  throw new Error(`No Matching \"${action.type}\" - action type`);\n};\n\nexport default cart_reducer;","map":{"version":3,"sources":["/home/thanh/react-course-comfy-sloth-starter/src/reducers/cart_reducer.js"],"names":["ADD_TO_CART","CLEAR_CART","COUNT_CART_TOTALS","REMOVE_CART_ITEM","TOGGLE_CART_ITEM_AMOUNT","cart_reducer","state","action","type","amount","subtotal","cart","reduce","acc","item","price","total","id","payload","product","color","flag","newProduct","i","length","mainColor","map","newAmount","stock","concat","shipping","newCart","filter","Error"],"mappings":"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","sourcesContent":["import {\n  ADD_TO_CART,\n  CLEAR_CART,\n  COUNT_CART_TOTALS,\n  REMOVE_CART_ITEM,\n  TOGGLE_CART_ITEM_AMOUNT,\n} from '../actions';\n\nconst cart_reducer = (state, action) => {\n  if (action.type === COUNT_CART_TOTALS) {\n    const { amount, subtotal } = state.cart.reduce(\n      (acc, item) => {\n        acc.amount += item.amount;\n        acc.subtotal += item.amount * item.price;\n        return acc;\n      },\n      {\n        amount: 0,\n        subtotal: 0,\n      }\n    );\n    return { ...state, amount: amount, total: subtotal };\n  }\n  if (action.type === ADD_TO_CART) {\n    const id = action.payload.product.id;\n    const color = action.payload.color;\n    let flag = false;\n    let newProduct = [];\n    const product = state.cart;\n    for (let i = 0; i < product.length; i++) {\n      if (product[i].id === id && product[i].mainColor === color) {\n        flag = true;\n        break;\n      }\n    }\n    if (flag) {\n      newProduct = state.cart.map((product) => {\n        if (product.id === id && product.mainColor === color) {\n          let newAmount = product.amount + action.payload.product.amount;\n          if (newAmount > product.stock) {\n            newAmount = product.stock;\n          }\n          return {\n            ...product,\n            amount: newAmount,\n          };\n        }\n        return product;\n      });\n    } else {\n      newProduct = state.cart.concat(action.payload.product);\n    }\n\n    return { ...state, cart: newProduct };\n  }\n  if (action.type === CLEAR_CART) {\n    return { ...state, cart: [], total: 0, amount: 0, shipping: 345 };\n  }\n  if (action.type === REMOVE_CART_ITEM) {\n    const id = action.payload.id;\n\n    const color = action.payload.color;\n\n    const newCart = state.cart.filter((item) => {\n      return item.id !== id && item.color !== color;\n    });\n    return { ...state, cart: newCart };\n  }\n\n  throw new Error(`No Matching \"${action.type}\" - action type`);\n};\n\nexport default cart_reducer;\n"]},"metadata":{},"sourceType":"module"}